(function(e){function t(t){for(var r,i,c=t[0],l=t[1],s=t[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(f.length)f.shift()();return o.push.apply(o,s||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,c=1;c<a.length;c++){var l=a[c];0!==n[l]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},o=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},"06dc":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"f",(function(){return d})),a.d(t,"e",(function(){return f})),a.d(t,"g",(function(){return h})),a.d(t,"b",(function(){return m}));a("e260"),a("fb6a"),a("e6cf"),a("1276"),a("498a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=[102,76,97,67],o=[73,68,51],i=[79,103,103,83],c=[102,116,121,112],l={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg"};function s(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])((function*(e){return yield new Promise(t=>{var a=new FileReader;a.onload=e=>{t(e.target.result)},a.readAsArrayBuffer(e)})})),u.apply(this,arguments)}function d(e,t,a){var r="",n="",o=a.split("-");return o.length>1?(r=o[0].trim(),n=o[1].trim()):1===o.length&&(n=o[0].trim()),"string"==typeof e&&""!==e&&(r=e),"string"==typeof t&&""!==t&&(n=t),{artist:r,title:n}}function f(e){var t="";if(void 0!==e.common.picture&&e.common.picture.length>0){var a=new Blob([e.common.picture[0].data],{type:e.common.picture[0].format});t=URL.createObjectURL(a)}return t}function h(e,t){return e.every((e,a)=>e===t[a])}function m(e,t){return h(o,e.slice(0,o.length))?"mp3":h(n,e.slice(0,n.length))?"flac":h(i,e.slice(0,i.length))?"ogg":h(c,e.slice(4,8))?"m4a":t}},1:function(e,t){},2:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("46a1"),a("450d");var r=a("e5f2"),n=a.n(r),o=(a("b5d8"),a("f494")),i=a.n(o),c=(a("560b"),a("dcdc")),l=a.n(c),s=(a("f225"),a("89a9")),u=a.n(s),d=(a("f4f9"),a("c2cc")),f=a.n(d),h=(a("7a0f"),a("0f6c")),m=a.n(h),p=(a("aaa5"),a("a578")),b=a.n(p),g=(a("adec"),a("3d2d")),y=a.n(g),v=(a("bdc7"),a("aa2f")),w=a.n(v),_=(a("de31"),a("c69e")),k=a.n(_),x=(a("5466"),a("ecdf")),O=a.n(x),j=(a("38a0"),a("ad41")),D=a.n(j),S=(a("1951"),a("eedf")),A=a.n(S),M=(a("acb6"),a("c673")),U=a.n(M),C=(a("fd71"),a("a447")),F=a.n(C),P=a("2b0e"),B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"app"}},[a("el-main",[a("x-upload",{on:{handle_finish:e.showSuccess,handle_error:e.showFail}}),a("el-row",{attrs:{id:"app-control"}},[a("el-row",{staticStyle:{"padding-bottom":"1em","font-size":"14px"}},[e._v(" 歌曲命名格式： "),a("el-radio",{attrs:{name:"format",label:"1"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌曲名")]),a("el-radio",{attrs:{name:"format",label:"2"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌手-歌曲名")]),a("el-radio",{attrs:{name:"format",label:"3"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌曲名-歌手")]),a("el-checkbox",{attrs:{border:""},model:{value:e.instant_download,callback:function(t){e.instant_download=t},expression:"instant_download"}},[e._v("立即保存")])],1),a("el-button",{attrs:{icon:"el-icon-download",plain:""},on:{click:e.handleDownloadAll}},[e._v("下载全部")]),a("el-button",{attrs:{icon:"el-icon-delete",plain:"",type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除全部")])],1),a("audio",{attrs:{autoplay:e.playing_auto,src:e.playing_url,controls:""}}),a("x-preview",{attrs:{"table-data":e.tableData,download_format:e.download_format},on:{music_changed:e.changePlaying}})],1),a("el-footer",{attrs:{id:"app-footer"}},[a("el-row",[e._v(" 音乐解锁：移除已购音乐的加密保护。 目前支持网易云音乐(ncm)、QQ音乐(qmc, mflac, tkm)以及 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/README.md",target:"_blank"}},[e._v("其他格式")]),e._v("。 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/wiki/使用提示",target:"_blank"}},[e._v("使用提示")])]),a("el-row",[a("span",[e._v("Copyright © 2019")]),a("a",{attrs:{href:"https://github.com/ix64",target:"_blank"}},[e._v("MengYX")]),e._v(" 音乐解锁使用 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/LICENSE",target:"_blank"}},[e._v("MIT许可协议")]),e._v(" 开放 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music",target:"_blank"}},[e._v("源代码")])])],1)],1)},E=[],L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{attrs:{"auto-upload":!1,"on-change":e.handleFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击选择")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("本工具仅在浏览器内对文件进行解锁，无需消耗流量")])])},T=[],q={name:"upload",data(){return{cacheQueue:[],workers:[],idle_workers:[],thread_num:1}},mounted(){if(""!==document.location.host){this.thread_num=navigator.hardwareConcurrency||1;var e=a("bfa2");this.workers.push(e().CommonDecrypt),this.idle_workers.push(0),setTimeout(()=>{for(var t=1;t<this.thread_num;t++)this.workers.push(e().CommonDecrypt),this.idle_workers.push(t)},1e3)}else{var t=a("bd2e");this.workers.push(t.CommonDecrypt),this.idle_workers.push(0)}},methods:{handleFile(e){this.idle_workers.length>0?this.handleDoFile(e,this.idle_workers.shift()):this.cacheQueue.push(e)},handleCacheQueue(e){0!==this.cacheQueue.length?this.handleDoFile(this.cacheQueue.shift(),e):this.idle_workers.push(e)},handleDoFile(e,t){this.workers[t](e).then(e=>{this.$emit("handle_finish",e),this.handleCacheQueue(t)}).catch(a=>{this.$emit("handle_error",a,e.name),this.handleCacheQueue(t)})}}},R=q,$=(a("b646"),a("2877")),I=Object($["a"])(R,L,T,!1,null,"36dd009c",null),N=I.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.picture}},[a("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[e._v(" 暂无封面 ")])])]}}])}),a("el-table-column",{attrs:{label:"歌曲"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"歌手"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.artist))])]}}])}),a("el-table-column",{attrs:{label:"专辑"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.album))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{circle:"",icon:"el-icon-video-play",type:"success"},on:{click:function(a){return e.handlePlay(t.$index,t.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-download"},on:{click:function(a){return e.handleDownload(t.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})]}}])})],1)},J=[];a("a434"),a("e260"),a("ddb0"),a("2b3d");function H(e,t){var a=document.createElement("a");switch(a.href=e.file,t){case"1":a.download=e.title+"."+e.ext;break;default:case"2":a.download=e.artist+" - "+e.title+"."+e.ext;break;case"3":a.download=e.title+" - "+e.artist+"."+e.ext;break}document.body.append(a),a.click(),a.remove()}function W(e){URL.revokeObjectURL(e.file),URL.revokeObjectURL(e.picture)}var K={name:"preview",props:{tableData:{type:Array,required:!0},download_format:{type:String,required:!0}},methods:{handlePlay(e,t){this.$emit("music_changed",t.file)},handleDelete(e,t){W(t),this.tableData.splice(e,1)},handleDownload(e){H(e,this.download_format)}}},z=K,V=Object($["a"])(z,Q,J,!1,null,"6856848d",null),X=V.exports,Y={name:"app",components:{xUpload:N,xPreview:X},data(){return{activeIndex:"1",tableData:[],playing_url:"",playing_auto:!1,download_format:"2",instant_download:!1}},created(){this.$nextTick((function(){this.finishLoad()}))},methods:{finishLoad(){var e=document.getElementById("loader-mask");e&&e.remove(),this.$notify.info({title:"离线使用",message:'我们使用PWA技术，无网络也能使用<br/>最近更新：提供实验性mgg支持<br/>点击查看 <a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:1e4,position:"top-left"})},showSuccess(e){if(e.status){this.instant_download?(H(e,this.download_format),W(e)):(this.tableData.push(e),this.$notify.success({title:"解锁成功",message:"成功解锁 "+e.title,duration:3e3}));var t=[e.title,e.artist,e.album];window._paq.push(["trackEvent","Unlock",e.rawExt+","+e.mime,JSON.stringify(t)])}else this.showFail(e.message,e.rawFilename+"."+e.rawExt)},showFail(e,t){this.$notify.error({title:"出现问题",message:e+"，"+t+'，参考<a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",e,t]),console.error(e,t)},changePlaying(e){this.playing_url=e,this.playing_auto=!0},handleDeleteAll(){this.tableData.forEach(e=>{W(e)}),this.tableData=[]},handleDownloadAll(){var e=0,t=setInterval(()=>{e<this.tableData.length?(H(this.tableData[e],this.download_format),e++):clearInterval(t)},300)}}},G=Y,Z=(a("034f"),Object($["a"])(G,B,E,!1,null,null,null)),ee=Z.exports,te=a("9483");Object(te["a"])("".concat("","service-worker.js"),{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});a("0fae");P["default"].use(F.a),P["default"].use(U.a),P["default"].use(A.a),P["default"].use(D.a),P["default"].use(O.a),P["default"].use(k.a),P["default"].use(w.a),P["default"].use(y.a),P["default"].use(b.a),P["default"].use(m.a),P["default"].use(f.a),P["default"].use(u.a),P["default"].use(l.a),P["default"].use(i.a),P["default"].prototype.$notify=n.a,P["default"].config.productionTip=!1,new P["default"]({render:e=>e(ee)}).$mount("#app")},"85ec":function(e,t,a){},"8a1e":function(e,t,a){},a8ee:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return c}));a("e260"),a("ace4"),a("5cc6"),a("b39a");var r=a("1da1"),n=a("fd2f"),o=a("06dc"),i=[0,0,0,32,102,116,121,112];function c(e,t){return l.apply(this,arguments)}function l(){return l=Object(r["a"])((function*(e,t){for(var a=yield Object(o["d"])(e),r=new Uint8Array(a),c=0;c<8;++c)r[c]=i[c];var l=new Blob([r],{type:"audio/mp4"});return yield Object(n["Decrypt"])(l,t,"m4a",!1)})),l.apply(this,arguments)}},b646:function(e,t,a){"use strict";var r=a("8a1e"),n=a.n(r);n.a},b6cf:function(e,t,a){"use strict";a.r(t);a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),o=(a("26e9"),[79,103,103,83,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,30,1,118,111,114,98,105,115,0,0,0,0,2,68,172,0,0,0,0,0,0,0,238,2,0,0,0,0,0,184,1,79,103,103,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,16,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,3,118,111,114,98,105,115,44,0,0,0,88,105,112,104,46,79,114,103,32,108,105,98,86,111,114,98,105,115,32,73,32,50,48,49,53,48,49,48,53,32,40,226,155,132,226,155,132,226,155,132,226,155,132,41,0,0,0,0,0,0,0,0,84,73,84,76,69,61]),i=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,6,3,3,3,3,6,6,6,6,3,3,3,3,6,6,6,6,6,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,6,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,1,9,9,0,1,9,9,9,9,9,9,9,9],c=[74,214,202,144,103,247,82,94,149,35,159,19,17,126,71,116,61,144,170,63,81,198,9,213,159,250,102,249,243,214,161,144,160,247,240,29,149,222,159,132,17,244,14,116,187,144,188,63,146,0,9,91,159,98,102,161],l=195,s=216;class u{constructor(e,t,a){void 0===t||void 0===a?(this.Matrix128=e,this.generateMask58from128()):(this.Matrix58=e,this.Super58A=t,this.Super58B=a,this.generateMask128from58())}generateMask128from58(){if(56!==this.Matrix58.length)throw"incorrect mask58 matrix length";for(var e=[],t=0;t<8;t+=1)e=e.concat([this.Super58A],this.Matrix58.slice(7*t,7*t+7),[this.Super58B],this.Matrix58.slice(49-7*t,56-7*t).reverse());this.Matrix128=e}generateMask58from128(){if(128!==this.Matrix128.length)throw"incorrect mask128 length";for(var e=this.Matrix128[0],t=this.Matrix128[8],a=[],r=0;r<8;r+=1){var o=16*r,i=120-o;if(this.Matrix128[o]!==e||this.Matrix128[o+8]!==t)throw"decode mask-128 to mask-58 failed";var c=this.Matrix128.slice(o+1,o+8),l=this.Matrix128.slice(i+1,i+8).reverse();if(!Object(n["g"])(c,l))throw"decode mask-128 to mask-58 failed";a=a.concat(c)}this.Matrix58=a,this.Super58A=e,this.Super58B=t}Decrypt(e){for(var t=e.slice(0),a=-1,r=-1,n=0;n<e.length;n++)a++,r++,(32768===a||a>32768&&(a+1)%32768===0)&&(a++,r++),r>=128&&(r-=128),t[n]^=this.Matrix128[r];return t}}function d(){return new u(c,l,s)}function f(e){for(var t,a=Math.min(32768,e.length),r=0;r<a;r+=128)try{if(t=new u(e.slice(r,r+128)),Object(n["g"])(n["c"],t.Decrypt(e.slice(0,n["c"].length))))break}catch(o){}return t}function h(e){if(!(e.length<o.length)){for(var t={},a=0;a<58;a++)t[a]={};for(var r=0;r<o.length;r++)if(0!==i[r]){var n=b(r),c=e[r]^o[r],l=i[r];c in t[n]?t[n][c]+=l:t[n][c]=l}var s,d,f=[];try{for(var h=0;h<56;h++)f[h]=p(t[h]);s=p(t[56]),d=p(t[57])}catch(m){return}return new u(f,s,d)}}function m(e,t,a){return new u(e,t,a)}function p(e){if(0===e.length)throw"can not match at least one key";var t,a=0;for(var r in e)e[r]>a&&(t=r,a=e[r]);return parseInt(t)}function b(e){e>127&&(e%=128);var t=e%16,a=(e-t)/16;switch(t){case 0:a=8,t=0;break;case 8:a=8,t=1;break;default:t>7?(a=7-a,t=15-t):t-=1;break}return 7*a+t}a.d(t,"Decrypt",(function(){return v}));var g=a("cb96"),y={mgg:{handler:h,ext:"ogg",detect:!0},mflac:{handler:f,ext:"flac",detect:!0},qmc0:{handler:d,ext:"mp3",detect:!1},qmc3:{handler:d,ext:"mp3",detect:!1},qmcogg:{handler:d,ext:"ogg",detect:!1},qmcflac:{handler:d,ext:"flac",detect:!1},bkcmp3:{handler:d,ext:"mp3",detect:!1},bkcflac:{handler:d,ext:"flac",detect:!1},tkm:{handler:d,ext:"m4a",detect:!1}};function v(e,t,a){return w.apply(this,arguments)}function w(){return w=Object(r["a"])((function*(e,t,a){if(!(a in y))return{status:!1,message:"File type is incorrect!"};var r,o,i,c=y[a],l=new Uint8Array(yield Object(n["d"])(e));if(c.detect){if(r=l.slice(0,-368),o=c.handler(r),i=l.slice(-368),void 0===o&&(o=yield k(i,t,a)),void 0===o)return{status:!1,message:a+"格式仅提供实验性支持！"}}else r=l,o=c.handler(r);var s=o.Decrypt(r),u=Object(n["b"])(s,c.ext),d=n["a"][u],f=new Blob([s],{type:d}),h=yield g.parseBlob(f),m=Object(n["f"])(h.common.artist,h.common.title,t);return c.detect&&_(i,o.Matrix128,m.artist,m.title,h.common.album,t,a),{status:!0,title:m.title,artist:m.artist,ext:u,album:h.common.album,picture:Object(n["e"])(h),file:URL.createObjectURL(f),mime:d}})),w.apply(this,arguments)}function _(e,t,a,r,n,o,i){fetch("https://stats.ixarea.com/collect/qmcmask/usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Mask:Array.from(t),Key:Array.from(e),Artist:a,Title:r,Album:n,Filename:o,Format:i})}).then().catch()}function k(e,t,a){return x.apply(this,arguments)}function x(){return x=Object(r["a"])((function*(e,t,a){try{var r=yield fetch("https://stats.ixarea.com/collect/qmcmask/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Format:a,Key:Array.from(e),Filename:t})}),n=yield r.json();return m(n.Matrix58,n.Super58A,n.Super58B)}catch(o){}})),x.apply(this,arguments)}},bd2e:function(e,t,a){"use strict";a.r(t),a.d(t,"CommonDecrypt",(function(){return l}));a("baa5");var r=a("1da1"),n=a("dde9"),o=a("b6cf"),i=a("fd2f"),c=a("a8ee");function l(e){return s.apply(this,arguments)}function s(){return s=Object(r["a"])((function*(e){var t,a=e.name.substring(e.name.lastIndexOf(".")+1,e.name.length).toLowerCase(),r=e.name.substring(0,e.name.lastIndexOf("."));switch(a){case"ncm":t=yield n.Decrypt(e.raw);break;case"mp3":case"flac":case"m4a":case"ogg":t=yield i.Decrypt(e.raw,r,a);break;case"tm0":case"tm3":t=yield i.Decrypt(e.raw,r,"mp3");break;case"qmc3":case"qmc0":case"qmcflac":case"qmcogg":case"tkm":case"bkcmp3":case"bkcflac":case"mflac":case"mgg":t=yield o.Decrypt(e.raw,r,a);break;case"tm2":case"tm6":t=yield c.Decrypt(e.raw,r);break;default:t={status:!1,message:"不支持此文件格式"}}return t.rawExt=a,t.rawFilename=r,t})),s.apply(this,arguments)}},bfa2:function(e,t,a){var r=a("3d67"),n=["CommonDecrypt"];e.exports=function(){var e=new Worker(a.p+"7c97d4b429b34158ca49.worker.js",{name:"[hash].worker.js"});return r(e,n),e}},dde9:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return s}));a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("25f0"),a("5319"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),o=a("3452"),i=a("7907"),c=o.enc.Hex.parse("687a4852416d736f356b496e62617857"),l=o.enc.Hex.parse("2331346C6A6B5F215C5D2630553C2728");function s(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])((function*(e){var t=yield Object(n["d"])(e),a=new DataView(t);if(1313166403!==a.getUint32(0,!0)||1296122950!==a.getUint32(4,!0))return{status:!1,message:"此ncm文件已损坏"};for(var r=h(a,t,10),o=m(r.data),i=p(a,t,r.offset),c=i.data,l=i.offset+a.getUint32(i.offset+5,!0)+13,s=new Uint8Array(t,l),u=0;u<s.length;++u)s[u]^=o[255&u];void 0===c.format&&(c.format=Object(n["b"])(s,"mp3"));var f=n["a"][c.format],b=[];c.artist.forEach(e=>b.push(e[0])),"mp3"===c.format&&(s=yield d(s,b,c.musicName,c.album,c.albumPic));var g=new Blob([s],{type:f});return{status:!0,title:c.musicName,artist:b.join(" & "),ext:c.format,album:c.album,picture:c.albumPic,file:URL.createObjectURL(g),mime:f}})),u.apply(this,arguments)}function d(e,t,a,r,n){return f.apply(this,arguments)}function f(){return f=Object(r["a"])((function*(e,t,a,r,n){var o=new i(e);if(o.setFrame("TPE1",t).setFrame("TIT2",a).setFrame("TALB",r),""!==n)try{var c=yield(yield fetch(n)).arrayBuffer();o.setFrame("APIC",{type:3,data:c,description:"Cover"})}catch(l){console.log("Fail to write cover image!")}return o.addTag(),o.arrayBuffer})),f.apply(this,arguments)}function h(e,t,a){var r=e.getUint32(a,!0);a+=4;var n=new Uint8Array(t,a,r).map(e=>100^e);a+=r;for(var i=o.AES.decrypt({ciphertext:o.lib.WordArray.create(n)},c,{mode:o.mode.ECB,padding:o.pad.Pkcs7}),l=new Uint8Array(i.sigBytes),s=i.words,u=i.sigBytes,d=0;d<u;d++)l[d]=s[d>>>2]>>>24-d%4*8&255;return{offset:a,data:l.slice(17)}}function m(e){for(var t=new Uint8Array(Array(256).keys()),a=e.length,r=0,n=0;n<256;n++)r=t[n]+r+e[n%a]&255,[t[n],t[r]]=[t[r],t[n]];return t.map((e,t,a)=>{t=t+1&255;var r=a[t],n=a[t+r&255];return a[r+n&255]})}function p(e,t,a){var r=e.getUint32(a,!0);if(a+=4,0===r)return{};var n=new Uint8Array(t,a,r).map(e=>99^e);a+=r;var i=o.AES.decrypt({ciphertext:o.enc.Base64.parse(o.lib.WordArray.create(n.slice(22)).toString(o.enc.Utf8))},l,{mode:o.mode.ECB,padding:o.pad.Pkcs7}),c=JSON.parse(i.toString(o.enc.Utf8).slice(6));return c.albumPic=c.albumPic.replace("http:","https:"),{data:c,offset:a}}},fd2f:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return i}));a("e260"),a("ace4"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),o=a("cb96");function i(e,t,a){return c.apply(this,arguments)}function c(){return c=Object(r["a"])((function*(e,t,a){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=a;if(r){var c=new Uint8Array(yield Object(n["d"])(e));i=Object(n["b"])(c,a),i!==a&&(e=new Blob([c],{type:n["a"][i]}))}var l=yield o.parseBlob(e),s=Object(n["f"])(l.common.artist,l.common.title,t);return{status:!0,title:s.title,artist:s.artist,ext:i,album:l.common.album,picture:Object(n["e"])(l),file:URL.createObjectURL(e),mime:n["a"][i]}})),c.apply(this,arguments)}}});
//# sourceMappingURL=app.6e6c2728.js.map