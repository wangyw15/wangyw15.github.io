(function(e){function t(t){for(var r,o,c=t[0],l=t[1],s=t[2],d=0,f=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,s||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,c=1;c<a.length;c++){var l=a[c];0!==n[l]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},"06dc":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"f",(function(){return d})),a.d(t,"e",(function(){return f})),a.d(t,"g",(function(){return p})),a.d(t,"b",(function(){return m}));a("e260"),a("fb6a"),a("e6cf"),a("1276"),a("498a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=[102,76,97,67],i=[73,68,51],o=[79,103,103,83],c=[102,116,121,112],l={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg"};function s(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])((function*(e){return yield new Promise(t=>{var a=new FileReader;a.onload=e=>{t(e.target.result)},a.readAsArrayBuffer(e)})})),u.apply(this,arguments)}function d(e,t,a){var r="",n="",i=a.split("-");return i.length>1?(r=i[0].trim(),n=i[1].trim()):1===i.length&&(n=i[0].trim()),"string"==typeof e&&""!==e&&(r=e),"string"==typeof t&&""!==t&&(n=t),{artist:r,title:n}}function f(e){var t="";if(void 0!==e.common.picture&&e.common.picture.length>0){var a=new Blob([e.common.picture[0].data],{type:e.common.picture[0].format});t=URL.createObjectURL(a)}return t}function p(e,t){return e.every((e,a)=>e===t[a])}function m(e,t){return p(i,e.slice(0,i.length))?"mp3":p(n,e.slice(0,n.length))?"flac":p(o,e.slice(0,o.length))?"ogg":p(c,e.slice(4,8))?"m4a":t}},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("46a1"),a("450d");var r=a("e5f2"),n=a.n(r),i=(a("b5d8"),a("f494")),o=a.n(i),c=(a("560b"),a("dcdc")),l=a.n(c),s=(a("f225"),a("89a9")),u=a.n(s),d=(a("f4f9"),a("c2cc")),f=a.n(d),p=(a("7a0f"),a("0f6c")),m=a.n(p),h=(a("aaa5"),a("a578")),b=a.n(h),v=(a("adec"),a("3d2d")),y=a.n(v),g=(a("bdc7"),a("aa2f")),w=a.n(g),_=(a("de31"),a("c69e")),k=a.n(_),x=(a("5466"),a("ecdf")),O=a.n(x),j=(a("38a0"),a("ad41")),D=a.n(j),S=(a("1951"),a("eedf")),A=a.n(S),M=(a("acb6"),a("c673")),U=a.n(M),C=(a("fd71"),a("a447")),F=a.n(C),P=a("2b0e"),B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"app"}},[a("el-main",[a("x-upload",{on:{handle_error:e.showFail,handle_finish:e.showSuccess}}),a("el-row",{attrs:{id:"app-control"}},[a("el-row",{staticStyle:{"padding-bottom":"1em","font-size":"14px"}},[e._v(" 歌曲命名格式： "),a("el-radio",{attrs:{label:"1",name:"format"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌手-歌曲名")]),a("el-radio",{attrs:{label:"2",name:"format"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌曲名")]),a("el-radio",{attrs:{label:"3",name:"format"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("歌曲名-歌手")]),a("el-radio",{attrs:{label:"4",name:"format"},model:{value:e.download_format,callback:function(t){e.download_format=t},expression:"download_format"}},[e._v("同原文件名")])],1),a("el-row",[a("el-button",{attrs:{icon:"el-icon-download",plain:""},on:{click:e.handleDownloadAll}},[e._v("下载全部")]),a("el-button",{attrs:{icon:"el-icon-delete",plain:"",type:"danger"},on:{click:e.handleDeleteAll}},[e._v("删除全部")]),a("el-checkbox",{staticStyle:{"margin-left":"1em"},attrs:{border:""},model:{value:e.instant_download,callback:function(t){e.instant_download=t},expression:"instant_download"}},[e._v("立即保存")])],1)],1),a("audio",{attrs:{autoplay:e.playing_auto,src:e.playing_url,controls:""}}),a("x-preview",{attrs:{download_format:e.download_format,"table-data":e.tableData},on:{music_changed:e.changePlaying}})],1),a("el-footer",{attrs:{id:"app-footer"}},[a("el-row",[a("a",{attrs:{href:"https://github.com/ix64/unlock-music",target:"_blank"}},[e._v("音乐解锁")]),e._v("(v"),a("span",{domProps:{textContent:e._s(e.version)}}),e._v(")：移除已购音乐的加密保护。 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/wiki/使用提示",target:"_blank"}},[e._v("使用提示")])]),a("el-row",[e._v(" 目前支持网易云音乐(ncm)、QQ音乐(qmc, mflac, mgg, tkm)以及 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/README.md",target:"_blank"}},[e._v("其他格式")]),e._v("。 ")]),a("el-row",[a("span",[e._v("Copyright © 2019")]),e._v(" MengYX 音乐解锁使用 "),a("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/LICENSE",target:"_blank"}},[e._v("MIT许可协议")]),e._v(" 开放源代码 ")])],1)],1)},E=[],T=(a("e6cf"),a("1da1")),L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{attrs:{"auto-upload":!1,"on-change":e.handleFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击选择")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("本工具仅在浏览器内对文件进行解锁，无需消耗流量")])])},q=[],R={name:"upload",data(){return{cacheQueue:[],workers:[],idle_workers:[],thread_num:1}},mounted(){if(""!==document.location.host){this.thread_num=navigator.hardwareConcurrency||1;var e=a("bfa2");this.workers.push(e().CommonDecrypt),this.idle_workers.push(0),setTimeout(()=>{for(var t=1;t<this.thread_num;t++)this.workers.push(e().CommonDecrypt),this.idle_workers.push(t)},1e3)}else{var t=a("bd2e");this.workers.push(t.CommonDecrypt),this.idle_workers.push(0)}},methods:{handleFile(e){this.idle_workers.length>0?this.handleDoFile(e,this.idle_workers.shift()):this.cacheQueue.push(e)},handleCacheQueue(e){0!==this.cacheQueue.length?this.handleDoFile(this.cacheQueue.shift(),e):this.idle_workers.push(e)},handleDoFile(e,t){this.workers[t](e).then(e=>{this.$emit("handle_finish",e),this.handleCacheQueue(t)}).catch(a=>{this.$emit("handle_error",a,e.name),this.handleCacheQueue(t)})}}},$=R,I=(a("b646"),a("2877")),N=Object(I["a"])($,L,q,!1,null,"36dd009c",null),J=N.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.picture}},[a("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[e._v(" 暂无封面 ")])])]}}])}),a("el-table-column",{attrs:{label:"歌曲"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"歌手"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.artist))])]}}])}),a("el-table-column",{attrs:{label:"专辑"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.album))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{circle:"",icon:"el-icon-video-play",type:"success"},on:{click:function(a){return e.handlePlay(t.$index,t.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-download"},on:{click:function(a){return e.handleDownload(t.row)}}}),a("el-button",{attrs:{circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})]}}])})],1)},H=[];a("a434"),a("e260"),a("ddb0"),a("2b3d");function W(e,t){var a=document.createElement("a");switch(a.href=e.file,t){default:case"1":a.download=e.artist+" - "+e.title+"."+e.ext;break;case"2":a.download=e.title+"."+e.ext;break;case"3":a.download=e.title+" - "+e.artist+"."+e.ext;break;case"4":a.download=e.rawFilename+"."+e.ext;break}document.body.append(a),a.click(),a.remove()}function V(e){URL.revokeObjectURL(e.file),URL.revokeObjectURL(e.picture)}var z={name:"preview",props:{tableData:{type:Array,required:!0},download_format:{type:String,required:!0}},methods:{handlePlay(e,t){this.$emit("music_changed",t.file)},handleDelete(e,t){V(t),this.tableData.splice(e,1)},handleDownload(e){W(e,this.download_format)}}},K=z,X=Object(I["a"])(K,Q,H,!1,null,"6856848d",null),Y=X.exports,G=a("9224"),Z={name:"app",components:{xUpload:J,xPreview:Y},data(){return{version:G.version,activeIndex:"1",tableData:[],playing_url:"",playing_auto:!1,download_format:"1",instant_download:!1}},created(){this.$nextTick((function(){this.finishLoad()}))},methods:{finishLoad(){var e=this;return Object(T["a"])((function*(){var t,a=document.getElementById("loader-mask");a&&a.remove();try{var r=yield fetch("https://stats.ixarea.com/collect/music/app-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Version:e.version})});t=yield r.json()}catch(n){}t&&t.Found?e.$notify.warning({title:"发现更新",message:"发现新版本 v"+t.Version+"<br/>更新详情："+t.Detail+'<br/><a target="_blank" href="'+t.URL+'">获取更新</a>',dangerouslyUseHTMLString:!0,duration:15e3,position:"top-left"}):e.$notify.info({title:"离线使用",message:"我们使用PWA技术，无网络也能使用<br/>最近更新："+G.updateInfo+'<br/><a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:1e4,position:"top-left"})}))()},showSuccess(e){if(e.status){this.instant_download?(W(e,this.download_format),V(e)):(this.tableData.push(e),this.$notify.success({title:"解锁成功",message:"成功解锁 "+e.title,duration:3e3}));var t=[e.title,e.artist,e.album];window._paq.push(["trackEvent","Unlock",e.rawExt+","+e.mime,JSON.stringify(t)])}else this.showFail(e.message,e.rawFilename+"."+e.rawExt)},showFail(e,t){this.$notify.error({title:"出现问题",message:e+"，"+t+'，参考<a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",e,t]),console.error(e,t)},changePlaying(e){this.playing_url=e,this.playing_auto=!0},handleDeleteAll(){this.tableData.forEach(e=>{V(e)}),this.tableData=[]},handleDownloadAll(){var e=0,t=setInterval(()=>{e<this.tableData.length?(W(this.tableData[e],this.download_format),e++):clearInterval(t)},300)}}},ee=Z,te=(a("034f"),Object(I["a"])(ee,B,E,!1,null,null,null)),ae=te.exports,re=a("9483");Object(re["a"])("".concat("","service-worker.js"),{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available."),window.location.reload()},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});a("0fae");P["default"].use(F.a),P["default"].use(U.a),P["default"].use(A.a),P["default"].use(D.a),P["default"].use(O.a),P["default"].use(k.a),P["default"].use(w.a),P["default"].use(y.a),P["default"].use(b.a),P["default"].use(m.a),P["default"].use(f.a),P["default"].use(u.a),P["default"].use(l.a),P["default"].use(o.a),P["default"].prototype.$notify=n.a,P["default"].config.productionTip=!1,new P["default"]({render:e=>e(ae)}).$mount("#app")},"85ec":function(e,t,a){},"8a1e":function(e,t,a){},9224:function(e){e.exports=JSON.parse('{"name":"unlock-music","version":"1.3.3","updateInfo":"支持网易云音乐DJ类型ncm；优化旧浏览器的支持","license":"MIT","description":"Unlock encrypted music file in browser.","repository":{"type":"git","url":"https://github.com/ix64/unlock-music"},"private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build","fix-compatibility":"node ./src/fix-compatibility.js"},"dependencies":{"browser-id3-writer":"^4.4.0","core-js":"^3.6.4","crypto-js":"^4.0.0","element-ui":"^2.13.0","music-metadata-browser":"^2.0.4","register-service-worker":"^1.6.2","vue":"^2.6.11"},"devDependencies":{"@vue/cli-plugin-babel":"^4.2.3","@vue/cli-plugin-pwa":"^4.2.3","@vue/cli-service":"^4.2.3","babel-plugin-component":"^1.1.1","vue-cli-plugin-element":"^1.0.1","vue-template-compiler":"^2.6.11","workerize-loader":"^1.1.0"}}')},a8ee:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return c}));a("e260"),a("ace4"),a("5cc6"),a("b39a");var r=a("1da1"),n=a("fd2f"),i=a("06dc"),o=[0,0,0,32,102,116,121,112];function c(e,t){return l.apply(this,arguments)}function l(){return l=Object(r["a"])((function*(e,t){for(var a=yield Object(i["d"])(e),r=new Uint8Array(a),c=0;c<8;++c)r[c]=o[c];var l=new Blob([r],{type:"audio/mp4"});return yield Object(n["Decrypt"])(l,t,"m4a",!1)})),l.apply(this,arguments)}},b646:function(e,t,a){"use strict";var r=a("8a1e"),n=a.n(r);n.a},b6cf:function(e,t,a){"use strict";a.r(t);a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),i=(a("26e9"),[79,103,103,83,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,30,1,118,111,114,98,105,115,0,0,0,0,2,68,172,0,0,0,0,0,0,0,238,2,0,0,0,0,0,184,1,79,103,103,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,16,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,3,118,111,114,98,105,115,44,0,0,0,88,105,112,104,46,79,114,103,32,108,105,98,86,111,114,98,105,115,32,73,32,50,48,49,53,48,49,48,53,32,40,226,155,132,226,155,132,226,155,132,226,155,132,41,0,0,0,0,0,0,0,0,84,73,84,76,69,61]),o=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,6,3,3,3,3,6,6,6,6,3,3,3,3,6,6,6,6,6,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,6,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,1,9,9,0,1,9,9,9,9,9,9,9,9],c=[74,214,202,144,103,247,82,94,149,35,159,19,17,126,71,116,61,144,170,63,81,198,9,213,159,250,102,249,243,214,161,144,160,247,240,29,149,222,159,132,17,244,14,116,187,144,188,63,146,0,9,91,159,98,102,161],l=195,s=216;class u{constructor(e,t,a){void 0===t||void 0===a?(this.Matrix128=e,this.generateMask58from128()):(this.Matrix58=e,this.Super58A=t,this.Super58B=a,this.generateMask128from58())}generateMask128from58(){if(56!==this.Matrix58.length)throw"incorrect mask58 matrix length";for(var e=[],t=0;t<8;t+=1)e=e.concat([this.Super58A],this.Matrix58.slice(7*t,7*t+7),[this.Super58B],this.Matrix58.slice(49-7*t,56-7*t).reverse());this.Matrix128=e}generateMask58from128(){if(128!==this.Matrix128.length)throw"incorrect mask128 length";for(var e=this.Matrix128[0],t=this.Matrix128[8],a=[],r=0;r<8;r+=1){var i=16*r,o=120-i;if(this.Matrix128[i]!==e||this.Matrix128[i+8]!==t)throw"decode mask-128 to mask-58 failed";var c=this.Matrix128.slice(i+1,i+8),l=this.Matrix128.slice(o+1,o+8).reverse();if(!Object(n["g"])(c,l))throw"decode mask-128 to mask-58 failed";a=a.concat(c)}this.Matrix58=a,this.Super58A=e,this.Super58B=t}Decrypt(e){for(var t=e.slice(0),a=-1,r=-1,n=0;n<e.length;n++)a++,r++,(32768===a||a>32768&&(a+1)%32768===0)&&(a++,r++),r>=128&&(r-=128),t[n]^=this.Matrix128[r];return t}}function d(){return new u(c,l,s)}function f(e){for(var t,a=Math.min(32768,e.length),r=0;r<a;r+=128)try{if(t=new u(e.slice(r,r+128)),Object(n["g"])(n["c"],t.Decrypt(e.slice(0,n["c"].length))))break}catch(i){}return t}function p(e){if(!(e.length<i.length)){for(var t={},a=0;a<58;a++)t[a]={};for(var r=0;r<i.length;r++)if(0!==o[r]){var n=b(r),c=e[r]^i[r],l=o[r];c in t[n]?t[n][c]+=l:t[n][c]=l}var s,d,f=[];try{for(var p=0;p<56;p++)f[p]=h(t[p]);s=h(t[56]),d=h(t[57])}catch(m){return}return new u(f,s,d)}}function m(e,t,a){return new u(e,t,a)}function h(e){if(0===e.length)throw"can not match at least one key";var t,a=0;for(var r in e)e[r]>a&&(t=r,a=e[r]);return parseInt(t)}function b(e){e>127&&(e%=128);var t=e%16,a=(e-t)/16;switch(t){case 0:a=8,t=0;break;case 8:a=8,t=1;break;default:t>7?(a=7-a,t=15-t):t-=1;break}return 7*a+t}a.d(t,"Decrypt",(function(){return g}));var v=a("cb96"),y={mgg:{handler:p,ext:"ogg",detect:!0},mflac:{handler:f,ext:"flac",detect:!0},qmc0:{handler:d,ext:"mp3",detect:!1},qmc3:{handler:d,ext:"mp3",detect:!1},qmcogg:{handler:d,ext:"ogg",detect:!1},qmcflac:{handler:d,ext:"flac",detect:!1},bkcmp3:{handler:d,ext:"mp3",detect:!1},bkcflac:{handler:d,ext:"flac",detect:!1},tkm:{handler:d,ext:"m4a",detect:!1}};function g(e,t,a){return w.apply(this,arguments)}function w(){return w=Object(r["a"])((function*(e,t,a){if(!(a in y))return{status:!1,message:"File type is incorrect!"};var r,i,o,c=y[a],l=new Uint8Array(yield Object(n["d"])(e));if(c.detect){if(r=l.slice(0,-368),i=c.handler(r),o=l.slice(-368),void 0===i&&(i=yield k(o,t,a)),void 0===i)return{status:!1,message:a+"格式仅提供实验性支持！"}}else r=l,i=c.handler(r);var s=i.Decrypt(r),u=Object(n["b"])(s,c.ext),d=n["a"][u],f=new Blob([s],{type:d}),p=yield v.parseBlob(f),m=Object(n["f"])(p.common.artist,p.common.title,t);return c.detect&&_(o,i.Matrix128,m.artist,m.title,p.common.album,t,a),{status:!0,title:m.title,artist:m.artist,ext:u,album:p.common.album,picture:Object(n["e"])(p),file:URL.createObjectURL(f),mime:d}})),w.apply(this,arguments)}function _(e,t,a,r,n,i,o){fetch("https://stats.ixarea.com/collect/qmcmask/usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Mask:Array.from(t),Key:Array.from(e),Artist:a,Title:r,Album:n,Filename:i,Format:o})}).then().catch()}function k(e,t,a){return x.apply(this,arguments)}function x(){return x=Object(r["a"])((function*(e,t,a){try{var r=yield fetch("https://stats.ixarea.com/collect/qmcmask/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Format:a,Key:Array.from(e),Filename:t})}),n=yield r.json();return m(n.Matrix58,n.Super58A,n.Super58B)}catch(i){}})),x.apply(this,arguments)}},bd2e:function(e,t,a){"use strict";a.r(t),a.d(t,"CommonDecrypt",(function(){return l}));a("baa5");var r=a("1da1"),n=a("dde9"),i=a("b6cf"),o=a("fd2f"),c=a("a8ee");function l(e){return s.apply(this,arguments)}function s(){return s=Object(r["a"])((function*(e){var t,a=e.name.substring(e.name.lastIndexOf(".")+1,e.name.length).toLowerCase(),r=e.name.substring(0,e.name.lastIndexOf("."));switch(a){case"ncm":t=yield n.Decrypt(e.raw,r,a);break;case"mp3":case"flac":case"m4a":case"ogg":t=yield o.Decrypt(e.raw,r,a);break;case"tm0":case"tm3":t=yield o.Decrypt(e.raw,r,"mp3");break;case"qmc3":case"qmc0":case"qmcflac":case"qmcogg":case"tkm":case"bkcmp3":case"bkcflac":case"mflac":case"mgg":t=yield i.Decrypt(e.raw,r,a);break;case"tm2":case"tm6":t=yield c.Decrypt(e.raw,r);break;default:t={status:!1,message:"不支持此文件格式"}}return t.rawExt=a,t.rawFilename=r,t})),s.apply(this,arguments)}},bfa2:function(e,t,a){var r=a("3d67"),n=["CommonDecrypt"];e.exports=function(){var e=new Worker(a.p+"c7f1b888cc86c49430d7.worker.js",{name:"[hash].worker.js"});return r(e,n),e}},dde9:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return s}));a("c975"),a("e260"),a("fb6a"),a("ace4"),a("e6cf"),a("25f0"),a("5319"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),i=a("3452"),o=a("7907"),c=i.enc.Hex.parse("687a4852416d736f356b496e62617857"),l=i.enc.Hex.parse("2331346C6A6B5F215C5D2630553C2728");function s(e,t,a){return u.apply(this,arguments)}function u(){return u=Object(r["a"])((function*(e,t,a){var r=yield Object(n["d"])(e),i=new DataView(r);if(1313166403!==i.getUint32(0,!0)||1296122950!==i.getUint32(4,!0))return{status:!1,message:"此ncm文件已损坏"};for(var o=p(i,r,10),c=m(o.data),l=h(i,r,o.offset),s=l.data,u=l.offset+i.getUint32(l.offset+5,!0)+13,f=new Uint8Array(r,u),b=0;b<f.length;++b)f[b]^=c[255&b];void 0===s.album&&(s.album="");var v=[];s.artist&&s.artist.forEach(e=>v.push(e[0]));var y=Object(n["f"])(v.join(" & "),s.musicName,t);0===v.length&&v.push(y.artist),void 0===s.format&&(s.format=Object(n["b"])(f,"mp3")),"mp3"===s.format&&(f=yield d(f,v,y.title,s.album,s.albumPic));var g=n["a"][s.format],w=new Blob([f],{type:g});return{status:!0,title:y.title,artist:y.artist,ext:s.format,album:s.album,picture:s.albumPic,file:URL.createObjectURL(w),mime:g}})),u.apply(this,arguments)}function d(e,t,a,r,n){return f.apply(this,arguments)}function f(){return f=Object(r["a"])((function*(e,t,a,r,n){var i=new o(e);if(i.setFrame("TPE1",t).setFrame("TIT2",a).setFrame("TALB",r),""!==n)try{var c=yield(yield fetch(n)).arrayBuffer();i.setFrame("APIC",{type:3,data:c,description:"Cover"})}catch(l){console.log("Fail to write cover image!")}return i.addTag(),i.arrayBuffer})),f.apply(this,arguments)}function p(e,t,a){var r=e.getUint32(a,!0);a+=4;var n=new Uint8Array(t,a,r).map(e=>100^e);a+=r;for(var o=i.AES.decrypt({ciphertext:i.lib.WordArray.create(n)},c,{mode:i.mode.ECB,padding:i.pad.Pkcs7}),l=new Uint8Array(o.sigBytes),s=o.words,u=o.sigBytes,d=0;d<u;d++)l[d]=s[d>>>2]>>>24-d%4*8&255;return{offset:a,data:l.slice(17)}}function m(e){for(var t=new Uint8Array(Array(256).keys()),a=e.length,r=0,n=0;n<256;n++)r=t[n]+r+e[n%a]&255,[t[n],t[r]]=[t[r],t[n]];return t.map((e,t,a)=>{t=t+1&255;var r=a[t],n=a[t+r&255];return a[r+n&255]})}function h(e,t,a){var r=e.getUint32(a,!0);if(a+=4,0===r)return{data:{},offset:a};var n=new Uint8Array(t,a,r).map(e=>99^e);a+=r;var o=i.AES.decrypt({ciphertext:i.enc.Base64.parse(i.lib.WordArray.create(n.slice(22)).toString(i.enc.Utf8))},l,{mode:i.mode.ECB,padding:i.pad.Pkcs7}).toString(i.enc.Utf8),c=o.indexOf(":"),s=JSON.parse(o.slice(c+1));return"dj"===o.slice(0,c)&&(s=s.mainMusic),s.albumPic=s.albumPic.replace("http:","https:"),{data:s,offset:a}}},fd2f:function(e,t,a){"use strict";a.r(t),a.d(t,"Decrypt",(function(){return o}));a("e260"),a("ace4"),a("5cc6"),a("b39a"),a("ddb0"),a("2b3d");var r=a("1da1"),n=a("06dc"),i=a("cb96");function o(e,t,a){return c.apply(this,arguments)}function c(){return c=Object(r["a"])((function*(e,t,a){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=a;if(r){var c=new Uint8Array(yield Object(n["d"])(e));o=Object(n["b"])(c,a),o!==a&&(e=new Blob([c],{type:n["a"][o]}))}var l=yield i.parseBlob(e),s=Object(n["f"])(l.common.artist,l.common.title,t);return{status:!0,title:s.title,artist:s.artist,ext:o,album:l.common.album,picture:Object(n["e"])(l),file:URL.createObjectURL(e),mime:n["a"][o]}})),c.apply(this,arguments)}}});